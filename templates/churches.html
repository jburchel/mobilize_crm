{% extends "base.html" %}

{% block page_title %}Churches{% endblock %}
{% block page_description %}Manage your church partnerships and relationships{% endblock %}

{% block content %}
<div class="churches-header">
    <a href="{{ url_for('churches_bp.add_church_form') }}" class="button primary">Add Church</a>
</div>

<div class="search-container">
    <input type="text" id="churchSearch" placeholder="Search churches..." class="search-input">
</div>

<div class="card">
    <h3>All Churches</h3>
    <table>
        <thead>
            <tr>
                <th>Name</th>
                <th>Location</th>
                <th>Contact Info</th>
                <th>Main Contact</th>
            </tr>
        </thead>
        <tbody id="churchTableBody">
            {% for church in churches %}
            <tr class="church-row" data-search-text="{{ church.get_name() }} {{ church.location if church.location else (church.city + ', ' + church.state) if church.city and church.state else church.street_address }} {{ church.main_contact.get_name() if church.main_contact else '' }}">
                <td><a href="{{ url_for('churches_bp.church_detail', church_id=church.id) }}">{{ church.get_name() }}</a></td>
                <td>{{ church.location if church.location else (church.city + ', ' + church.state) if church.city and church.state else church.street_address }}</td>
                <td>
                    {% if church.phone %}ðŸ“ž {{ church.phone }}<br>{% endif %}
                    {% if church.email %}ðŸ“§ {{ church.email }}{% endif %}
                </td>
                <td>{{ church.main_contact.get_name() if church.main_contact else 'None' }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="4" class="text-center">No churches found</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById('churchSearch').addEventListener('input', function(e) {
    const searchText = e.target.value.toLowerCase();
    document.querySelectorAll('.church-row').forEach(row => {
        const rowText = row.dataset.searchText.toLowerCase();
        row.style.display = rowText.includes(searchText) ? '' : 'none';
    });
});
</script>
{% endblock %}

{% block styles %}
<style>
.churches-header {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    margin-bottom: 1rem;
}

.search-container {
    margin-bottom: 1rem;
}

.search-input {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #ddd;
    border-radius: var(--border-radius);
    max-width: 300px;
}

.search-input:focus {
    border-color: var(--primary-color);
    outline: none;
    box-shadow: 0 0 0 2px rgba(24, 57, 99, 0.1);
}

.text-center {
    text-align: center;
}

a.button.primary {
    background-color: var(--primary-color);
    color: var(--white-color);
    padding: 0.75rem 1.5rem;
    border-radius: var(--border-radius);
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    transition: all var(--transition-speed) ease;
}

a.button.primary:hover {
    background-color: var(--secondary-color);
    transform: translateY(-1px);
    box-shadow: var(--card-hover-shadow);
}
</style>
{% endblock %}
